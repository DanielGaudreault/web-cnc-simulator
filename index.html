<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebCNC Pro - Professional CAM Software</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
</head>
<body>
    <!-- Top Toolbar -->
    <div class="top-toolbar">
        <div class="menu-bar">
            <div class="menu-item">File
                <div class="dropdown">
                    <div class="dropdown-item" onclick="fileManager.newProject()">New Project</div>
                    <div class="dropdown-item" onclick="fileManager.openProject()">Open Project</div>
                    <div class="dropdown-item" onclick="fileManager.saveProject()">Save Project</div>
                    <div class="dropdown-item" onclick="fileManager.importFile()">Import...</div>
                    <div class="dropdown-item" onclick="fileManager.exportGCode()">Export G-code</div>
                </div>
            </div>
            <div class="menu-item">Edit
                <div class="dropdown">
                    <div class="dropdown-item">Undo</div>
                    <div class="dropdown-item">Redo</div>
                    <div class="dropdown-item">Copy</div>
                    <div class="dropdown-item">Paste</div>
                    <div class="dropdown-item">Transform</div>
                </div>
            </div>
            <div class="menu-item">View
                <div class="dropdown">
                    <div class="dropdown-item" onclick="viewportManager.setView('top')">Top View</div>
                    <div class="dropdown-item" onclick="viewportManager.setView('front')">Front View</div>
                    <div class="dropdown-item" onclick="viewportManager.setView('right')">Right View</div>
                    <div class="dropdown-item" onclick="viewportManager.setView('isometric')">Isometric</div>
                    <div class="dropdown-item" onclick="viewportManager.toggleFullscreen()">Fullscreen</div>
                </div>
            </div>
            <div class="menu-item">Machine
                <div class="dropdown">
                    <div class="dropdown-item" onclick="machineManager.selectMachine()">Machine Setup</div>
                    <div class="dropdown-item" onclick="postProcessor.selectPost()">Post Processor</div>
                    <div class="dropdown-item" onclick="simulationManager.setup()">Simulation Setup</div>
                </div>
            </div>
            <div class="menu-item">Tools
                <div class="dropdown">
                    <div class="dropdown-item" onclick="toolManager.openLibrary()">Tool Library</div>
                    <div class="dropdown-item" onclick="toolManager.createTool()">Create Tool</div>
                    <div class="dropdown-item" onclick="toolManager.importTools()">Import Tools</div>
                </div>
            </div>
            <div class="menu-item">Operations
                <div class="dropdown">
                    <div class="dropdown-item" onclick="operationManager.createOperation('contour')">Contour</div>
                    <div class="dropdown-item" onclick="operationManager.createOperation('pocket')">Pocket</div>
                    <div class="dropdown-item" onclick="operationManager.createOperation('drill')">Drill</div>
                    <div class="dropdown-item" onclick="operationManager.createOperation('face')">Face</div>
                    <div class="dropdown-item" onclick="operationManager.createOperation('engrave')">Engrave</div>
                </div>
            </div>
        </div>
        
        <div class="quick-access">
            <button class="toolbar-btn" onclick="fileManager.newProject()" title="New Project">üìÑ</button>
            <button class="toolbar-btn" onclick="fileManager.saveProject()" title="Save">üíæ</button>
            <button class="toolbar-btn" onclick="simulationManager.run()" title="Run Simulation">‚ñ∂Ô∏è</button>
            <button class="toolbar-btn" onclick="simulationManager.pause()" title="Pause">‚è∏Ô∏è</button>
            <button class="toolbar-btn" onclick="simulationManager.stop()" title="Stop">‚èπÔ∏è</button>
            <button class="toolbar-btn" onclick="postProcessor.generate()" title="Generate G-code">‚öôÔ∏è</button>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Sidebar - Operations Manager -->
        <div class="left-sidebar">
            <div class="operations-panel">
                <div class="panel-header">
                    <span>Operations Manager</span>
                    <button class="icon-btn" onclick="operationManager.addOperation()">+</button>
                </div>
                <div class="operations-list" id="operationsList">
                    <!-- Operations will be dynamically added here -->
                </div>
            </div>

            <div class="toolpath-panel">
                <div class="panel-header">Toolpath Visualization</div>
                <div class="toolpath-controls">
                    <label><input type="checkbox" checked onchange="toolpathManager.toggleRapidMoves(this.checked)"> Rapid Moves</label>
                    <label><input type="checkbox" checked onchange="toolpathManager.toggleCutMoves(this.checked)"> Cut Moves</label>
                    <label><input type="checkbox" onchange="toolpathManager.toggleTool(this.checked)"> Show Tool</label>
                </div>
            </div>
        </div>

        <!-- Main Viewport Area -->
        <div class="viewport-area">
            <!-- Multiple Viewports -->
            <div class="viewport-container">
                <div class="viewport" id="viewport3d">
                    <div class="viewport-label">3D View</div>
                    <canvas id="mainCanvas"></canvas>
                    <div class="viewport-controls">
                        <button onclick="viewportManager.zoomIn()">+</button>
                        <button onclick="viewportManager.zoomOut()">-</button>
                        <button onclick="viewportManager.fitAll()">Fit</button>
                    </div>
                </div>
                
                <div class="viewport" id="viewportTop">
                    <div class="viewport-label">Top View</div>
                    <canvas id="topCanvas"></canvas>
                </div>
                
                <div class="viewport" id="viewportFront">
                    <div class="viewport-label">Front View</div>
                    <canvas id="frontCanvas"></canvas>
                </div>
                
                <div class="viewport" id="viewportRight">
                    <div class="viewport-label">Right View</div>
                    <canvas id="rightCanvas"></canvas>
                </div>
            </div>

            <!-- Bottom Panel - G-code Editor -->
            <div class="gcode-panel">
                <div class="panel-tabs">
                    <button class="tab active" onclick="openTab('gcodeTab')">G-code</button>
                    <button class="tab" onclick="openTab('simulationTab')">Simulation</button>
                    <button class="tab" onclick="openTab('postTab')">Post Processing</button>
                </div>
                
                <div id="gcodeTab" class="tab-content active">
                    <div class="editor-toolbar">
                        <button onclick="gcodeEditor.format()">Format</button>
                        <button onclick="gcodeEditor.validate()">Validate</button>
                        <button onclick="gcodeEditor.optimize()">Optimize</button>
                        <button onclick="fileManager.exportGCode()">Export</button>
                    </div>
                    <textarea id="gcodeEditor" spellcheck="false"></textarea>
                </div>
                
                <div id="simulationTab" class="tab-content">
                    <div class="simulation-controls">
                        <button onclick="simulationManager.run()">Run</button>
                        <button onclick="simulationManager.pause()">Pause</button>
                        <button onclick="simulationManager.stop()">Stop</button>
                        <input type="range" id="simSpeed" min="1" max="100" value="50">
                        <span>Speed: <span id="speedValue">50%</span></span>
                    </div>
                    <div class="simulation-stats">
                        <div>Cycle Time: <span id="cycleTime">00:00</span></div>
                        <div>Material Removed: <span id="materialVolume">0 cm¬≥</span></div>
                        <div>Tool Changes: <span id="toolChanges">0</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar - Properties and Tool Library -->
        <div class="right-sidebar">
            <div class="properties-panel">
                <div class="panel-header">Properties</div>
                <div class="property-group">
                    <label>Workpiece Size</label>
                    <div class="property-row">
                        <input type="number" id="wpWidth" value="100" step="1"> X
                        <input type="number" id="wpHeight" value="100" step="1"> Y
                        <input type="number" id="wpDepth" value="25" step="1"> Z
                    </div>
                </div>
                
                <div class="property-group">
                    <label>Material</label>
                    <select id="materialType">
                        <option value="aluminum">Aluminum 6061</option>
                        <option value="steel">Steel 4140</option>
                        <option value="stainless">Stainless 304</option>
                        <option value="brass">Brass</option>
                        <option value="plastic">ABS Plastic</option>
                        <option value="wood">Hardwood</option>
                    </select>
                </div>

                <div class="property-group">
                    <label>Stock to Leave</label>
                    <div class="property-row">
                        <input type="number" id="stockXY" value="0.1" step="0.01"> XY
                        <input type="number" id="stockZ" value="0.1" step="0.01"> Z
                    </div>
                </div>
            </div>

            <div class="tool-library-panel">
                <div class="panel-header">
                    <span>Tool Library</span>
                    <button class="icon-btn" onclick="toolManager.openLibrary()">üìö</button>
                </div>
                <div class="tool-list" id="toolList">
                    <!-- Tools will be dynamically added here -->
                </div>
            </div>

            <div class="machine-panel">
                <div class="panel-header">Machine Setup</div>
                <select id="machineType">
                    <option value="3axis">3-Axis Mill</option>
                    <option value="4axis">4-Axis Mill</option>
                    <option value="5axis">5-Axis Mill</option>
                    <option value="lathe">CNC Lathe</option>
                    <option value="router">CNC Router</option>
                </select>
                
                <div class="machine-specs">
                    <div>X Travel: <span id="xTravel">500mm</span></div>
                    <div>Y Travel: <span id="yTravel">400mm</span></div>
                    <div>Z Travel: <span id="zTravel">300mm</span></div>
                    <div>Max RPM: <span id="maxRPM">10000</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
        <div class="status-left">
            <span id="cursorPos">X: 0.000 Y: 0.000 Z: 0.000</span>
            <span id="simulationStatus">Ready</span>
        </div>
        <div class="status-right">
            <span id="operationInfo">No Operation Selected</span>
            <span id="memoryUsage">Memory: 0MB</span>
        </div>
    </div>

    <!-- Modals -->
    <div id="toolLibraryModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Tool Library</h3>
            <div class="modal-body">
                <!-- Tool library content -->
            </div>
        </div>
    </div>

    <!-- Load Scripts -->
    <script src="js/vendors/three.js"></script>
    <script src="js/vendors/occt.js"></script>
    <script src="js/utils/geometry.js"></script>
    <script src="js/utils/gcode-parser.js"></script>
    <script src="js/utils/file-io.js"></script>
    <script src="js/core/cad-engine.js"></script>
    <script src="js/core/cam-engine.js"></script>
    <script src="js/core/simulator.js"></script>
    <script src="js/core/post-processor.js"></script>
    <script src="js/ui/tool-manager.js"></script>
    <script src="js/ui/operation-manager.js"></script>
    <script src="js/ui/viewport-manager.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
